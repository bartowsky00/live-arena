---
import Layout from '../layouts/Layout.astro';
import EventCard from '../components/EventCard.astro';
import { getUpcoming, getPast } from '../lib/events';

const upcomingEvents = await getUpcoming();
const pastEvents = await getPast();
---

<Layout title="Eventi" description="Scopri tutti gli eventi e concerti alla Live Arena di Agrigento. Acquista i biglietti per i prossimi spettacoli.">
  <!-- Hero Section -->
  <section class="relative pt-32 pb-20 md:pt-40 md:pb-28 overflow-hidden">
    <!-- Background -->
    <div class="absolute inset-0">
      <div class="absolute inset-0 bg-gradient-to-b from-arena-red/10 via-arena-black to-arena-black"></div>
      <div class="absolute top-0 left-1/2 -translate-x-1/2 w-[800px] h-[400px] bg-arena-red/20 blur-[150px] rounded-full"></div>
    </div>

    <div class="max-w-7xl mx-auto px-6 relative">
      <div class="text-center">
        <span class="text-arena-red text-sm tracking-[0.3em] uppercase mb-4 block animate-fade-in">Calendario</span>
        <h1 class="font-display text-6xl md:text-8xl tracking-wider text-white mb-6 animate-fade-up" style="animation-delay: 0.1s;">
          TUTTI GLI<br />
          <span class="text-arena-red">EVENTI</span>
        </h1>
        <p class="text-white/60 text-lg max-w-2xl mx-auto animate-fade-up" style="animation-delay: 0.2s;">
          I migliori artisti nazionali e internazionali sul palcoscenico della Live Arena.
        </p>
      </div>
    </div>
  </section>

  <!-- Filter Tabs -->
  <section class="bg-arena-black border-b border-white/5 sticky top-16 z-30 backdrop-blur-md bg-arena-black/90">
    <div class="max-w-7xl mx-auto px-6">
      <div class="flex gap-8" id="event-tabs">
        <button
          class="py-4 text-sm uppercase tracking-wider font-medium border-b-2 transition-colors tab-btn active"
          data-tab="upcoming"
        >
          Prossimi Eventi
          <span class="ml-2 px-2 py-0.5 bg-arena-red/20 text-arena-red text-xs rounded">{upcomingEvents.length}</span>
        </button>
        <button
          class="py-4 text-sm uppercase tracking-wider font-medium border-b-2 transition-colors tab-btn"
          data-tab="past"
        >
          Eventi Passati
          <span class="ml-2 px-2 py-0.5 bg-white/10 text-white/50 text-xs rounded">{pastEvents.length}</span>
        </button>
      </div>
    </div>
  </section>

  <!-- Upcoming Events -->
  <section class="py-16 md:py-24 bg-arena-black" id="upcoming-events">
    <div class="max-w-7xl mx-auto px-6">
      {upcomingEvents.length > 0 ? (
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
          {upcomingEvents.map((event, index) => (
            <div class="reveal" style={`animation-delay: ${index * 0.1}s`}>
              <EventCard
                id={event.slug}
                artist={event.artist}
                tour={event.tour}
                dateDisplay={event.dateDisplay}
                image={event.image}
                status={event.status as 'on-sale' | 'coming-soon' | 'sold-out' | 'past'}
              />
            </div>
          ))}
        </div>
      ) : (
        <div class="text-center py-16">
          <p class="text-white/50 text-lg">Nessun evento in programma al momento.</p>
          <p class="text-white/30 mt-2">Torna presto per scoprire i nuovi concerti!</p>
        </div>
      )}
    </div>
  </section>

  <!-- Past Events -->
  <section class="py-16 md:py-24 bg-arena-dark hidden" id="past-events">
    <div class="max-w-7xl mx-auto px-6">
      <div class="grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
        {pastEvents.map((event, index) => (
          <div class="reveal opacity-60 hover:opacity-100 transition-opacity" style={`animation-delay: ${index * 0.05}s`}>
            <EventCard
              id={event.slug}
              artist={event.artist}
              tour={event.tour}
              dateDisplay={event.dateDisplay}
              image={event.image}
              status={event.status as 'on-sale' | 'coming-soon' | 'sold-out' | 'past'}
            />
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- Info Section -->
  <section class="py-16 md:py-24 bg-arena-black border-t border-white/5">
    <div class="max-w-7xl mx-auto px-6">
      <div class="grid md:grid-cols-3 gap-12">
        <div class="reveal text-center md:text-left">
          <div class="w-12 h-12 bg-arena-red/10 flex items-center justify-center mb-4 mx-auto md:mx-0">
            <svg class="w-6 h-6 text-arena-red" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"></path>
            </svg>
          </div>
          <h3 class="font-display text-2xl tracking-wider text-white mb-3">ACQUISTA I BIGLIETTI</h3>
          <p class="text-white/50">
            I biglietti sono disponibili su TicketOne e TicketZeta. Clicca sull'evento per accedere ai link di acquisto.
          </p>
        </div>

        <div class="reveal reveal-delay-1 text-center md:text-left">
          <div class="w-12 h-12 bg-arena-red/10 flex items-center justify-center mb-4 mx-auto md:mx-0">
            <svg class="w-6 h-6 text-arena-red" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
            </svg>
          </div>
          <h3 class="font-display text-2xl tracking-wider text-white mb-3">COME ARRIVARE</h3>
          <p class="text-white/50">
            Via Esa Chimento, Agrigento. Ampio parcheggio disponibile. Raggiungi facilmente la venue in auto o con i mezzi pubblici.
          </p>
        </div>

        <div class="reveal reveal-delay-2 text-center md:text-left">
          <div class="w-12 h-12 bg-arena-red/10 flex items-center justify-center mb-4 mx-auto md:mx-0">
            <svg class="w-6 h-6 text-arena-red" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </div>
          <h3 class="font-display text-2xl tracking-wider text-white mb-3">INFORMAZIONI</h3>
          <p class="text-white/50">
            Per informazioni sugli eventi, contattaci attraverso i nostri canali social o visita la pagina contatti.
          </p>
        </div>
      </div>
    </div>
  </section>
</Layout>

<style>
  .tab-btn {
    border-color: transparent;
    color: rgba(255, 255, 255, 0.5);
  }

  .tab-btn:hover {
    color: rgba(255, 255, 255, 0.8);
  }

  .tab-btn.active {
    border-color: #DC2626;
    color: white;
  }

  @keyframes fadeUp {
    from {
      opacity: 0;
      transform: translateY(40px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fade-up {
    animation: fadeUp 0.8s ease-out forwards;
    opacity: 0;
  }

  .animate-fade-in {
    animation: fadeIn 0.6s ease-out forwards;
  }

  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
</style>

<script>
  const tabs = document.querySelectorAll('.tab-btn');
  const upcomingSection = document.getElementById('upcoming-events');
  const pastSection = document.getElementById('past-events');

  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      tabs.forEach(t => t.classList.remove('active'));
      tab.classList.add('active');

      const tabName = tab.getAttribute('data-tab');

      if (tabName === 'upcoming') {
        upcomingSection?.classList.remove('hidden');
        pastSection?.classList.add('hidden');
      } else {
        upcomingSection?.classList.add('hidden');
        pastSection?.classList.remove('hidden');
      }
    });
  });
</script>
